---------- 2016-02-04 ----------------
some notes on osc.
    * ZirkOSC only has a sending connection, to the local ip address 127.0.0.1, port 18032
    * Octogris, for the ipad connection, has a sending connection to the address/port specified in the
    relevant text boxes, and a receiving connection from the "default" local adress (obtained with
    getLocalIPAddress())
--------- 2016-02-10 -----------------
WHAT IS NEXT?
* review juce compiler warnings
* version windows
* en mode internal routing, désactiver les components inutiles(dans studio)
* utiliser mode HRTF avec zirkonium
* GUI
    * avoir une texture en background
    * try different fonts
--------- 2016-02-17 -------------
ok. so 2 problems
1- compared to octogris, spatgris surface (free volume) and span (pan span) are reversed.
2- only for source 1, setting volume (or pan) and reading it is reversed
-------- 2016-03-02 ------------
ok. so problem in reaper with number of inputs and outputs. 

what is critical, is that in processblock, we don't use more inputs/outputs than given by getTotal. 

so currently, getTotal for AU and VST3 is able to read the I/O number of inputs and outputs. NOT vst2.
Check if we can fix this using setPreferredBusArrangement. but if we do that, we need to remove Plugin Channel Configurations from introjucer

ok, there is an example surround plugin which looks at this very problem. With vst2, reaper seems to make a ton of random calls to setPrefferedBusArrangement, so not sure how to deal with that. Could recommend using vst3 with reaper, but need to ensure vst2 is working with DP. 

DP
Spatgris is crashing dp at the moment. Need to test surround. So apparently: 
* dp uses AU by default...
* i cannot load the surround plugin, even though it is in the plugin manager... BECAUSE IT IS A SYNTH. it works really well, and there are several calls to getPreferred, but it ends on createFront7point1. 

LOGIC
seems to also work, but needs to be tested more.

CHECKING OCTOGRIS3
DP: OK
reaper: vst2:OK, vst3: NAN, AU: ok
logic: (probably ok)

ok. so if octogris3 is working... could we not use the same code in SpatGRIS? well wait, vst3 was not working for octogris. but who gives a shit?
so current git version of octogris is the same source code as 3.0.1, but a different version of JUCE, which may be critical. let's try it. 
it doesn't work. so the juce version is probably to blame!

testing juce versions
LATEST PULL: 
* introjucer plygin channel config NOT deprecated
* spatgris 
    * au: load 2x2, 8x8 avail
    * vst3: same
    * vst2: load 2x2, 2x2 max avail


v4.0.1: 
* introjucer plugin channel config deprecated
* octogris vst2 ok, vst3 not
* spatgris: vst2 8x16, vst3 8x8, au 2x2 selected, 8x16 avail
* SO EVERYTHING WORKS. problem is with bleeding edge juce version. need to be careful with this for next JUCE release. 
------------- 2016-03-09 ----------------------
src and speaker positions need to be reset when prepare to play changes their numbers. 
alright, that's fixed. 

NOW #27
DP seems fine, other than lagging on trajectories...
Logic is quite troublesome. Having saved a project, on reopening no sound. Need to deactivate and reactivate main audio track. Then outputs 5 and 7 do not work, output 8 goes on 8 and 7, output 6 goes on 6 and 5. then if you stop playing and start it again, you start to lose some outputs, until only 4 is working. deactivating and reactivating spatgris on main track resets the behaviour. 

ok, one way to fix the outputs 8 and 6 being doubles on 7 and 5 is to use surround busses (hold the logo on the right of the input name on aux tracks to select surround bus input). 

but we still have the problem of the plugin needing to be re-initialized after stopping playback.
------------- 2016-03-23 -------------------
#47: Clicks audio au centre. 

Ces clicks semblent être causés par des shorts bursts d'activité dans tous les haut-parleurs. Au centre, c'est normal que tous les haut-parleurs soient solicités, j'imagine? Ce qu'il faut s'assurer est de ne pas avoir de transient super rapide. Est-ce qu'il y a déjà un algorithme qui regarde le delta inter-sample?

playing with param smoothing slider has an effect, mais ne rêgle pas complètement le problème de click audios. 

searching for ksmooth, I see that param smoothing is used in all process modes, in processor::ProcessData.
------------ 2016-03-24 ---------------
#51: osc spat thread leak
I think this can be fixed at the same time as #52 (source update thread not running when editor is
closed). 
Both threads need to run in the processor, and be deleted using an owned array.
----------- 2016-04-06 -----------
cur: 1e8e158a97fc260366d6d9505e0f38526750d940
ok. probleme bizarre ici, issue #59. Quel est le path de vie du mover?
* unique_ptr dans processor.h
* instancié fin du constructor processor
* passé au constructor de l'editor dans createEditor(), en tant que pointer normal (seems to be ok if nothing is messing with pointer ownership...).
* passé au constructor de FieldComponent dans editor constructor
* passe au constructor de trajectories dans buttonClicked()
* editor::getMover() sends the mover to HIDDelegate, OctoLeap, OscComponent


Alright, i don't see any obvious problems with the mover pointer, so looking into when sourceUpdateThread is run and stopped. 
It should run when 
    * we have more than 1 source
    * we're not recording automation
    * we're in a dependent mode

--- #47 ---
audio clicks. they don't seem to be due to a sudden big transient, although only tested difference between 2 samples, could be something more complicated... 
What if it is due to having all speakers activated at once? Or something similar, like the angle problem in the center? Looking at ProcessDataPanVolumeMode(). 

--------------------- 2016-04-13 ------------------
OK. problèmes en lien avec les performances:
    * Octogris #114: lag automation manuelles
    * Spatgris # 60: CPU prends trop de jus

Robert s'inquiète beaucoup de #114. 
    * DP (AU): 
        * dernier octogris (301) plus lent que spatgris
        * octogris 213 également a chier
        * octogris 225 > 226 (où arrive la trace) > 228 (trace est blanche)  
    * Logic(AU): spatgris aussi bad que octogris 301
    * Reaper: vst all good...!

Donc, on a:
    * AU vs VST
        * test this in reaper
            * 301: aucun problème
                * les CPU de Octogris VST, AU et grm spaces sont comparables.
                    * repos, sans interface: 9-10%
                    * repos, interface: 9-11%
                    * lecture automation, interface: 46% 
                    * ecriture automation manuelle: 57-58%
    * 225 vs 228
        * test this in DP
    * Octogris en general vs Spatgris
        * test this in logic
            * CPU
                * spatgris 011
                    * repos, interface ou pas : 3-4%
                    * ecriture automation manuelle:  80-85%
                    * lecture automation, interface: 51-60%
                * octogris 301
                    * repos, interface ou pas, 4-5%
                    * écriture automation manuelle: 58-68%, augmentation avec le temps, probablement a cause de la trace
                    * octogris 301 is cout-ing stuff!!!!
                        * removed them in 302, doesn't change performance...
                        * what about removing the trace?
                            * ecriture: peak 77%, lecture 56%, mieux mais pas parfait.
                            * looking at juce demo for ideas to optimise trace and other GUI things, I found the chain demo
                              in box2d, which is someone else's tests in opengl or something. Probably worth checking out
                              at some point...
        * DP 
            * CPU with trace, octogris 3.0.2
                * repos, interface ou pas 15%
                * ecriture manuelle 78-88%
                * lecture 68-70%
            *sans trace
                * repos, interface ou pas, 16-18%
                * ecriture 75-80%
                    * quand meme laggy a fond.
            * spatgris
                * repos 23-24
                * ecriture manuelle 86-87%, increasing with trace, better than octogris for sure
                * lecture 63%
                * lecture 60-70

TIMING AND TRYING THINGS
    I added a vector in which i push times from editor::timerCallBack. NEED TO TURN TIMING_THINGS MACRO OFF. Here are the various things I tried turning off:

    * trace
        helps a bit, try to print only last X subpaths
    * speaker levels
        * Turns out displaying speaker levels takes a lot of CPU, and not displaying them removes any visual lag from DP...!
        * so far this makes the biggest difference on gui and automation
        * disabled this when writing automation
    *these 2 calls take most of the time in repaint and are not useful at al during automation: updateSourceLocationTextEditor() and updateSpeakerLocationTextEditor(). 
        * but removing them make no difference on gui/automation lag
        * still deactivated them, because spending this much time on this is ludicrous!

--------------------- 2016-05-16 ------------------
#47
clicks when 
    * recording manual automation
    * reading manual automation
    * reading trajectory
    * recording trajectory that is fast enough, like .3s return  pendulum

looking at older versions
* v2.1.3. before joystick, internal routing, source unique
    * clicks everywhere, but recording pendulum at .3s no clicks (.1 sec yes)
* there's clicks in every single version. This is a problem rooted deep in the algorithm
------------------- 2016-05-30 ---------------------
Looking into spatialization algorithm
The thing with goddamn arrays is that you don't know their sizes. 
* parameters **inputs and **outputs are inputs[numInputChannels][p_iTotalSamples].
* 

------------------- 2016-06-02 ---------------------
looking into #56, the 0.0.0.0 issue. I'm now questioning what is going on here. Reason is that xcode also shows that touch osc messages are sent to 0.0.0.0, but when I put a wrong adress, ie not the ipad adress, then messages don't get to the ipad. Meaning that perhaps we are not sending on 0.0.0.0. 

However, now it seems that osc spat is just not working at all. Zirkonium is not responding to messages, and my OF oscreceiver is not displaying osc messages (it does display touch osc messages).

So. I need to make sure osc spat messages are sent. Turns out I had changed the ip adress. now seeing stuff.
-------------------- 2016-06-06 ------------------
#47. 

So. Here's how the algorithm should go:
    * is delta theta more than a quarter circle
        * yes:
            * need to ramp between prev and next theta, using locked thetas
        * no: 
    
    we need to not store mLockedThetas when r < kThetaLockRadius

continuing this on 2016-06-13. I created a reaper file with a crazy sharp automation on x position. I get clicks when the source oscillates over the center, but not when it oscillates over a non-center mid point. 

so I did a bunch of excel plots, and my algorithm doesn't work at all! Need to find a way to make it smoother when transitioning. .

06-16. I added Antoine's algo to my excel plot and it is weird! Je pense que son algo n'est peut-[etre pas tant pour gerer les clicks que pour empecher les delta thetas trop grands au centre du cercle. Right. Si je bypass le truc au complet, j'ai une belle progression sinusoidale. Il y a peut-etre quelque chose d'autre qui se passe directement au centre... genre avec le code qui suit?
J<Ai ajouté du code qui print les speakers qui jouent du son, et c'est toujours les mêmes. Les speakers et les delta speakers sont toujours les memes, donc il y a quelque chose que je ne comprends pas ici. 
I can't debug this at home because it says I only have 2 speakers... unless I use jack? nope, doesn't work. 

06-20. après avoir observé plusieurs graphes, j'en vient aux conclusions suivantes:
* mon hypothèse était qu'une transition instantanée de l'automation allait produire une transition instantanée de theta, et donc une transition instantanée entre 4 sets de haut-parleurs différents. C'est faux
    * Une automation instantané produit une sinusoide de theta
    * plein de changements produisent des transitions instantanées de HP, je ne pense pas que ça soit directement le problème
* je ne comprends pas bien ce qu'Antoine essayait de faire. Il semble y avoir une coupure pas rapport dans la transition d'Angle. 
* je pense que le problème est peut-être qu'on a plusieurs transition rapides entre des paires de haut-parleurs quand on passe d'un coté à l'autre. Ce que je pourrais faire est de complètement bloquer theta quand on arrive au centre, et de repartir directement avec le nouveau theta quand r > threshold. 
Idid this, and still the fucking clicks. I cannot figure out where the clicks come from! One clue is that there's no clicks if slightly off center...
--- 2016-06-27. new graphs to really compare clicks vs non clicks
* antoine center: changement entre 248 et 308 = 60 samples
* antoine off-center: changement entre 138 et 467 = 329 samples
It is simply the lenght of the transition that is causing a click? Probably. Could force staying with 1 speaker for at least, e.g., 50 samples. 

i made a new excel sheet, cause the first one crashed. J'ai refais les automations dans reaper pour avoir une transition entre 2 pointes collèes, une transition entre 2 pointes opposées sans passer par le center et genre 6 transitions en passant par le centre. Que je prenne l'algo d'antoine ou lockedNew, j'ai des clicks sur tous les passages par le centre. Comme les graphiques sont pas mal pareil, pas certain que ça vaille la peine de les comparer, il faut plus essayer de comprendre pkoi seulement les passages par le centre cliquent.  

----------------- 2016-06-15 -------------------
Looking into future general directions. 
Robert sent a new version of the zirkonium, alpha 12. Il n'est pas compatible avec jack, mais il est compatible avec soundflower. J'ai cloné le code de soundflower, et ça compile sur nicolai. J'ai aussi le code PD de vbap.

GENERAL TO DO HERE:
* understand vbap algorithm (read paper(s))
	* wait for David
* understand vbap PD code (zirkonium version or original)
	* wait for David
* understand what is required to have software being seen as audio cards, essentially what soundflower and jack do. 
* understand how to deal with audio outputs, ie what zirkonium does. 

----------------- 2016-06-24 ------------------
Trajectories. So I cleaned the trajectories that represent shapes, which are: 
* circle
* ellipse
* spiral
* pendulum
and not those
* random
* random target
* sym X and sym Y target
* closest speaker target

But in fact, the only two that don't make sense to accelerate are the randoms:
* random
* random target


